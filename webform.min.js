function webform_component_date_widget_form(a,b,c,d,e,f,g){try{var h=g.options.attributes.id;g.type="hidden";for(var i={title:g.title,type:"select",options:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec",attributes:{id:h+"-month",onchange:"_webform_date_component_onchange('month', '"+h+"');"}}},j={type:"select",options:{attributes:{id:h+"-day",onchange:"_webform_date_component_onchange('day', '"+h+"');"}}},k=1;k<=31;k++)j.options[k]=k;var l={options:{attributes:{id:h+"-year",onchange:"_webform_date_component_onchange('year', '"+h+"');"}}};if(f.extra.year_textfield)l.type="number";else{l.type="select";var m=webform_date_component_parse_range(f);if(m){m.start_date.interval!=m.end_date.interval&&console.log("WARNING: webform_form() - only matching start/end intervals supported ("+m.start_date.interval+" != "+m.end_date.interval+")");var n=null,o=null,p=parseInt(date("Y"));switch(m.start_date.interval){case"year":case"years":n=p+m.start_date.value,o=p+m.end_date.value;break;default:console.log("WARNING: webform_form() - unsupported date interval ("+m.start_date.interval+")")}}for(var k=n;k<=o;k++)l.options[k]=k}g.children.push(i),g.children.push(j),g.children.push(l)}catch(q){console.log("webform_component_date_widget_form - "+q)}}function webform_component_fieldset_widget_form(a,b,c,d,e,f,g){try{g.type="hidden"}catch(h){console.log("webform_component_fieldset_widget_form - "+h)}}function webform_component_grid_widget_form(a,b,c,d,e,f,g){try{var h=g.options.attributes.id;g.type="hidden",g.value_callback="webform_component_grid_value_callback",g.form_id=a.id;for(var i=f.extra.options.split("\n"),j=f.extra.questions.split("\n"),k=0;k<j.length;k++){var l=j[k].split("|");if(2==l.length){for(var m={type:"radios",title:l[1],prefix:'<fieldset data-role="controlgroup" data-type="horizontal">',suffix:"</fieldset>",options:{attributes:{id:h+"-question-"+k}}},n=0;n<i.length;n++){var o=i[n].split("|");2==o.length&&(m.options[o[0]]=o[1])}g.children.push(m)}}}catch(p){console.log("webform_component_grid_widget_form - "+p)}}function webform_component_markup_widget_form(a,b,c,d,e,f,g){try{g.options.attributes.id;g.type=null,g.title="",g.markup=f.value}catch(h){console.log("webform_component_markup_widget_form - "+h)}}function webform_component_multifile_widget_form(a,b,c,d,e,f,g){try{g.type="hidden"}catch(h){console.log("webform_component_multifile_widget_form - "+h)}}function webform_component_number_widget_form(a,b,c,d,e,f,g){try{g.options.attributes.id;f.extra.integer?(empty(f.extra.min)||(g.options.attributes.min=f.extra.min),empty(f.extra.max)||(g.options.attributes.max=f.extra.max),empty(f.extra.step)||(g.options.attributes.step=f.extra.step)):g.type="textfield"}catch(h){console.log("webform_component_number_widget_form - "+h)}}function webform_component_phone_widget_form(a,b,c,d,e,f,g){try{g.type="textfield"}catch(h){console.log("webform_component_phone_widget_form - "+h)}}function webform_component_select_widget_form(a,b,c,d,e,f,g){try{if(webform_component_is_hybrid(f))return void webform_hybrid_component_select_widget_form(a,b,c,d,e,f,g);var h=(g.options.attributes.id,f.extra.aslist),i=f.extra.items.split("\n");if(h){var j=g.required?t("- Select -"):t("- None -");g.options[""]=j}f.extra.optrand&&(i=shuffle(i));for(var k=0;k<i.length;k++){var l=i[k].split("|");2==l.length&&(g.options[l[0]]=l[1])}h?f.extra.multiple&&(g.options.attributes["data-native-menu"]="false",g.options.attributes.multiple="multiple"):f.extra.multiple?g.type="checkboxes":g.type="radios"}catch(m){console.log("webform_component_select_widget_form - "+m)}}function webform_component_time_widget_form(a,b,c,d,e,f,g){try{g.type="hidden";var h=g.options.attributes.id,i={type:"select",title:g.title,options:{attributes:{id:h+"-hours",onchange:"_webform_time_component_onchange('hours', '"+h+"');"}}},j=null;if("12-hour"==f.extra.hourformat){for(var k=1;k<=12;k++)i.options[k]=k;j={type:"radios",value:"am",options:{am:"am",pm:"pm",attributes:{id:h+"-ampm",onchange:"_webform_time_component_onchange('ampm', '"+h+"');"}}}}else if("24-hour"==f.extra.hourformat)for(var k=0;k<=23;k++)i.options[k]=k;for(var l={type:"select",options:{attributes:{id:h+"-minutes",onchange:"_webform_time_component_onchange('minutes', '"+h+"');"}}},k=0;k<60;k+=parseInt(f.extra.minuteincrements)){var m=k,n=""+k;1==n.length&&(n="0"+n),l.options[m]=n}g.children.push(i),g.children.push(l),j&&g.children.push(j)}catch(o){console.log("webform_component_time_widget_form - "+o)}}function _webform_date_component_onchange(a,b){try{var c=$("#"+b+"-year").val(),d=$("#"+b+"-month").val();1==d.length&&(d="0"+d);var e=$("#"+b+"-day").val();1==e.length&&(e="0"+e);var f=c+"-"+d+"-"+e;$("#"+b).val(f)}catch(g){console.log("_webform_date_component_onchange - "+g)}}function _webform_time_component_onchange(a,b){try{var c=$('input[name="'+b+'-ampm"]:checked',"form#webform_form").val(),d=$("#"+b+"-hours").val();c&&"pm"==c&&(d=(parseInt(d)+12)%24);var e=$("#"+b+"-minutes").val();1==e.length&&(e="0"+e);var f=d+":"+e+":00";$("#"+b).val(f)}catch(g){console.log("_webform_time_component_onchange - "+g)}}function webform_component_grid_value_callback(a,b){try{for(var c={},d=(b.component.extra.options.split("\n"),b.component.extra.questions.split("\n")),e=0;e<d.length;e++){var f=d[e].split("|");2==f.length&&(c[f[0]]=$('input[name="'+a+"-question-"+e+'"]:checked',"form#"+b.form_id).val())}return empty(c)?null:c}catch(g){console.log("webform_component_grid_value_callback - "+g)}}function webform_form(a,b,c,d,e){try{if(a.options.attributes.class+=" webform ",a.id+="_"+d+"_"+c[entity_primary_key(d)],a.webform=c.webform,a.uuid=c.uuid,$.each(c.webform.components,function(f,g){var h=g.name;"none"==g.extra.title_display&&(h="");var i=1==parseInt(g.required),j=!(g.extra.private&&!user_access("access all webform results"));a.elements[g.form_key]={component:g,type:g.type,title:g.extra.description_above?"":h,required:i,value:webform_tokens_replace(g.value),description:g.extra.description_above?"":webform_tokens_replace(g.extra.description),prefix:g.extra.description_above?theme("form_element_label",{element:{title:h}})+'<div class="description">'+webform_tokens_replace(g.extra.description)+"</div>":"",disabled:g.extra.disabled,access:j,options:{attributes:{id:drupalgap_form_get_element_id(g.form_key,a.id)}},children:[],weight:parseInt(g.weight)};var k="webform_component_"+g.type+"_widget_form";if(function_exists(k)){var l=window[k];l(a,b,c,d,e,g,a.elements[g.form_key])}}),"undefined"!=typeof a.elements.webform_hybrid_component){_webform_hybrid_nid=c.nid;var f=webform_hybrid_load(c.nid);$.each(f.collapsible_items,function(b,c){a.elements.webform_hybrid_component.children.push({markup:theme("collapsible",c)})}),a.elements.webform_hybrid_component.children.push({markup:drupalgap_jqm_page_event_script_code({page_id:drupalgap_get_page_id(),jqm_page_event:"pageshow",jqm_page_event_callback:"webform_hybrid_component_pageshow",jqm_page_event_args:JSON.stringify({nid:c.nid})})})}var g=empty(c.webform.submit_text)?"Submit":c.webform.submit_text;return a.elements.submit={type:"submit",value:g},a}catch(h){console.log("webform_form - "+h)}}function webform_form_pageshow(a){try{return}catch(b){console.log("webform_form_pageshow - "+b)}}function webform_form_validate(a,b){try{"undefined"!=typeof b.values.webform_hybrid_component&&$.each(a.webform.components,function(c,d){var e=webform_hybrid_load_component(a.webform.nid,c);b.values[d.form_key]=e.extra.drupalgap_webform_hybrid_values})}catch(c){console.log("webform_form_validate - "+c)}}function webform_form_submit(a,b){try{var c={uid:Drupal.user.uid,data:{}};$.each(a.webform.components,function(a,d){var e=b.values[d.form_key];"string"==typeof e&&(e=[e]),c.data[a]={values:e}});var d=a.webform_submission_update?webform_submission_update:webform_submission_create;d(a.uuid,c,{success:function(b){switch(a.webform.redirect_url){default:var c=a.webform.confirmation;if(empty(c)||drupalgap_set_message(c),a.action!==!1){var d=drupalgap_path_get();"string"==typeof a.action&&(d=a.action),drupalgap_goto(d,{reloadPage:!0})}}},error:function(a,b,c){if(c=JSON.parse(c),c&&c.form_errors){var d="";$.each(c.form_errors,function(a,b){d+=b+"\n"}),drupalgap_alert(d)}else drupalgap_alert(c)}})}catch(e){console.log("webform_form_submit - "+e)}}function webform_date_component_parse_range(a){try{for(var b={},c=["start_date","end_date"],d=0;d<c.length;d++){var e=c[d];if(a.extra[e]){var f=a.extra[e].split(" ");b[e]={value:parseInt(f[0].replace("+","")),interval:f[1]}}}return empty(b)?null:b}catch(g){console.log("webform_date_component_parse_range - "+g)}}function webform_results_container_id(a){try{return"webform_results_container_"+a}catch(b){console.log("webform_results_container_id - "+b)}}function webform_submission_container_id(a,b){try{return"webform_submission_container_"+a+"_"+b}catch(c){console.log("webform_results_container_id - "+c)}}function webform_tokens_replace(a){try{if(!a)return"";for(var b,c,d=a.split(" "),e=0;e<d.length;e++){if(b="",c="",0==d[e].indexOf("%"))0==d[e].indexOf("%username")&&0!=Drupal.user.uid?(c="%username",b=Drupal.user.name):0==d[e].indexOf("%useremail")&&0!=Drupal.user.uid?(c="%useremail",b=Drupal.user.mail):0==d[e].indexOf("%ip_address")?(c="%ip_address",b=drupalgap_get_ip()):0==d[e].indexOf("%site")?(c="%site",b=drupalgap.settings.title):0==d[e].indexOf("%nid")?(c="%nid",b=entity.nid):0==d[e].indexOf("%title")&&(c="%title",b=entity.title);else if(0==d[e].indexOf("[current-page:query:")){var f=d[e].replace("[current-page:query:","").replace("]","");c="[current-page:query:"+f+"]",b=_GET(f)}empty(b)||(a=a.replace(c,b))}return a}catch(g){console.log("webform_tokens_replace - "+g)}}function webform_select_component_get_options(a){try{if(!a||!a.extra||!a.extra.items)return null;for(var b={},c=a.extra.items.split("\n"),d=0;d<c.length;d++){var e=c[d].split("|");2==e.length&&(b[e[0]]=e[1])}return b}catch(f){console.log("webform_select_component_get_options - "+f)}}function webform_load_from_current_page(){try{return webform_load_form_from_page().webform}catch(a){console.log("webform_load_from_current_page - "+a)}}function webform_load_form_from_page(a){try{return a||(a=$("#"+drupalgap_get_page_id()+" form.webform").attr("id")),drupalgap_form_local_storage_load(a)}catch(b){console.log("webform_load_from_current_page - "+b)}}function webform_load_component(a,b){try{var c=null;return $.each(a.components,function(a,d){if(d.cid==b)return c=d,!1}),c}catch(d){console.log("webform_load_component - "+d)}}function webform_submission_result_is_empty(a){try{var b=!1;return $.isArray(a)&&0===a.length?b=!0:$.isEmptyObject(a)&&(b=!0),b}catch(c){console.log("webform_submission_result_is_empty - "+c)}}function webform_menu(){try{var a={};return a["node/%/webform-results"]={title:"Results",page_callback:"webform_results_page",pageshow:"webform_results_pageshow",page_arguments:[1],weight:10,type:"MENU_LOCAL_TASK",access_callback:"user_access",access_arguments:["access all webform results"]},a["webform/submission/%/%"]={title:"Submission",page_callback:"webform_submission_page",pageshow:"webform_submission_pageshow",page_arguments:[2,3],access_callback:"user_access",access_arguments:["access all webform results"]},a}catch(b){console.log("webform_menu - "+b)}}function webform_entity_post_render_content(a,b,c){try{"undefined"!=typeof a.webform?a.content+=drupalgap_form_render(drupalgap_form_load("webform_form",a,b,c))+drupalgap_jqm_page_event_script_code({page_id:drupalgap_get_page_id(),jqm_page_event:"pageshow",jqm_page_event_callback:"webform_form_pageshow",jqm_page_event_args:JSON.stringify({nid:a.nid,uuid:a.uuid})}):console.log("webform was undefined for "+c+" "+a.nid)}catch(d){console.log("webform_entity_post_render_content - "+d)}}function webform_services_preprocess(a){try{if("submission"==a.service&&in_array(a.resource,["create","update"])){var b=JSON.parse(a.data);$.each(b.submission.data,function(a,c){$.isArray(c.values)&&0==c.values.length&&(b.submission.data[a]={})}),a.data=JSON.stringify(b)}}catch(c){console.log("webform_services_preprocess - "+c)}}function webform_services_postprocess(a,b){try{if("webform"==a.service&&"submissions"==a.resource){if(0==b.length)return;b.length>1&&console.log("NOTE: webform_services_postprocess only handles the first submission");var c=webform_load_from_current_page(),d=b[0];$.each(d.data,function(a,b){var d=webform_load_component(c,b.cid);if(d&&webform_component_is_hybrid(d)){var e=b.values,f=webform_hybrid_load_component(c.nid,d.cid);f.extra.drupalgap_webform_hybrid_values=[],webform_submission_result_is_empty(e)||(f.extra.drupalgap_webform_hybrid_values=e)}})}}catch(e){console.log("webform_services_postprocess - "+e)}}function webform_component_is_hybrid(a){try{return"undefined"!=typeof a.extra.drupalgap_webform_select_hybrid&&a.extra.drupalgap_webform_select_hybrid}catch(b){console.log("webform_component_is_hybrid - "+b)}}function webform_hybrid_load(a){try{return"undefined"==typeof webform_hybrid_components[a]&&(webform_hybrid_components[a]={components:{},items:{},collapsible_items:[]}),webform_hybrid_components[a]}catch(b){console.log("webform_hybrid_load - "+b)}}function webform_hybrid_load_component(a,b){try{var c=webform_hybrid_load(a);return"undefined"==typeof c.components[b]?null:c.components[b]}catch(d){console.log("webform_hybrid_load_component - "+d)}}function webform_hybrid_component_select_widget_form(a,b,c,d,e,f,g){try{var h=f.nid,i=f.cid,j=webform_hybrid_load(h);j.components[i]=f,"undefined"==typeof a.elements.webform_hybrid_component&&(a.elements.webform_hybrid_component={type:"autocomplete",items:[],weight:g.weight-1,item_onclick:"webform_hybrid_component_select_item_onclick",children:[]});var k=webform_select_component_get_options(f),l={};$.each(k,function(a,b){l[b]=a}),$.each(l,function(b,c){a.elements.webform_hybrid_component.items.push({value:c,label:b,attributes:{cid:f.cid}})}),j.collapsible_items.push({header:f.name,content:"<p></p>",attributes:{cid:i,class:"webform_hybrid_component"}}),delete a.elements[f.form_key]}catch(m){console.log("webform_hybrid_component_select_widget_form - "+m)}}function webform_hybrid_component_pageshow(a){try{var b=a.nid;$(".webform_hybrid_component").on("collapsibleexpand",function(a,c){if(!_webform_hybrid_expanding){var d=$(a.target).attr("cid"),e=webform_hybrid_load_component(b,d),f=webform_select_component_get_options(e);if(f){var g=[];$.each(f,function(a,c){var f={title:c,attributes:{id:b+"-"+d+"-"+a,value:a,onclick:"webform_hybrid_checkbox_click(this)"}},h=$.isArray(e.extra.drupalgap_webform_hybrid_values);h&&in_array(a,e.extra.drupalgap_webform_hybrid_values)?f.attributes.checked="":h||"object"!=typeof e.extra.drupalgap_webform_hybrid_values||$.each(e.extra.drupalgap_webform_hybrid_values,function(b,c){if(b==a&&"0"!=c)return f.attributes.checked="",!1});var i={element:f};i.element.id=f.attributes.id,g.push(theme("checkbox",f)+theme("form_element_label",i))}),_webform_hybrid_expanding=!0,setTimeout(function(){$(a.target).find("p").html(theme("jqm_item_list",{items:g,attributes:{"data-theme":"b"}})).trigger("create"),_webform_hybrid_expanding=!1},50)}}})}catch(c){console.log("webform_hybrid_component_pageshow - "+c)}}function webform_hybrid_component_select_item_onclick(a,b){try{var c=$(b).attr("value"),d=$(b).attr("cid"),e=drupalgap_get_page_id(),f=$("#"+e+' div[cid="'+d+'"]');$(f).collapsible("expand"),setTimeout(function(){var a="#"+e+" input#"+_webform_hybrid_nid+"-"+d+"-"+c,b=$(a),f=84;$("html, body").animate({scrollTop:$(b).offset().top-f},1e3)},50)}catch(g){console.log("webform_hybrid_component_select_item_onclick - "+g)}}function webform_hybrid_checkbox_click(a){try{var b=$(a),c=b.is(":checked"),d=b.attr("id").split("-"),e=d[0],f=d[1],g=d[2],h=webform_hybrid_load_component(e,f);if("undefined"==typeof h.extra.drupalgap_webform_hybrid_values&&(h.extra.drupalgap_webform_hybrid_values={}),c)$.isArray(h.extra.drupalgap_webform_hybrid_values)?h.extra.drupalgap_webform_hybrid_values.push(g):"object"==typeof h.extra.drupalgap_webform_hybrid_values&&(h.extra.drupalgap_webform_hybrid_values[g]=""+g);else if($.isArray(h.extra.drupalgap_webform_hybrid_values)){var i=h.extra.drupalgap_webform_hybrid_values.indexOf(g);i!=-1&&h.extra.drupalgap_webform_hybrid_values.splice(i,1)}else"object"==typeof h.extra.drupalgap_webform_hybrid_values&&(h.extra.drupalgap_webform_hybrid_values[g]="0");module_invoke_all("webform_hybrid_checkbox_click",a)}catch(j){console.log("webform_hybrid_checkbox_click - "+j)}}function webform_results_page(a){try{var b={};return b.results={markup:'<div id="'+webform_results_container_id(a)+'"></div>'},b}catch(c){console.log("webform_results_page - "+c)}}function webform_results_pageshow(a){try{var b={};node_load(a,{success:function(c){webform_submissions(c.uuid,b,{success:function(b){$("#"+webform_results_container_id(a)).html(theme("webform_results",{results:b})).trigger("create")}})}})}catch(c){console.log("webform_results_page - "+c)}}function webform_submission_page(a,b){try{var c={};return c.results={markup:'<div id="'+webform_submission_container_id(a,b)+'"></div>'},c}catch(d){console.log("webform_submission_page - "+d)}}function webform_submission_pageshow(a,b){try{webform_submission_retrieve(b,{success:function(c){switch(a){case"view":var d=c.webform.split("/"),e=d[d.length-1];webform_webform_retrieve(e,{success:function(d){$("#"+webform_submission_container_id(a,b)).html(theme("webform_submission",{result:c,webform:d})).trigger("create")}})}}})}catch(c){console.log("webform_submission_pageshow - "+c)}}function webform_submission_create(a,b,c){try{c.method="POST",c.data=JSON.stringify({webform:a,submission:b}),c.path="submission.json",c.service="submission",c.resource="create",Drupal.services.call(c)}catch(d){console.log("webform_submission_create - "+d)}}function webform_submission_retrieve(a,b){try{b.method="GET",b.path="submission/"+a+".json",b.service="submission",b.resource="retrieve",Drupal.services.call(b)}catch(c){console.log("webform_submission_retrieve - "+c)}}function webform_webform_retrieve(a,b){try{b.method="GET",b.path="webform/"+a+".json",b.service="webform",b.resource="retrieve",Drupal.services.call(b)}catch(c){console.log("webform_submission_retrieve - "+c)}}function webform_submission_update(a,b,c){try{c.method="PUT",c.data=JSON.stringify({submission:b}),c.path="submission/"+a+".json",c.service="submission",c.resource="update",Drupal.services.call(c)}catch(d){console.log("webform_submission_update - "+d)}}function webform_submission_delete(a,b,c){try{console.log("WARNING: webform_submission_delete() not implemented yet!")}catch(d){console.log("webform_submission_delete - "+d)}}function webform_submissions(a,b,c){try{c.method="GET",c.path="webform/"+a+"/submissions.json"+webform_prepare_query_string(b),c.service="webform",c.resource="submissions",Drupal.services.call(c)}catch(d){console.log("webform_submissions - "+d)}}function webform_submission_index(a,b){try{return void alert("webform_submission_index is deprecated! Use webform_submissions() instead.")}catch(c){console.log("webform_submission_index - "+c)}}function webform_prepare_query_string(a){try{var b="";return"object"==typeof a?b=entity_index_build_query_string(a):"string"==typeof a&&(b=a),b=b?"&"+b:""}catch(c){console.log("webform_prepare_query_string - "+c)}}function theme_webform_results(a){try{var b=[];b.push({data:"#"}),b.push({data:"Submitted"}),b.push({data:"User"}),b.push({data:"IP Address"}),b.push({data:"Operations"});var c=[];$.each(a.results,function(a,b){var d=new Date(1e3*b.submitted);d=d.toGMTString(),c.push([b.sid,d,b.user,b.remote_addr,theme("button_link",{text:"View",path:"webform/submission/view/"+b.uuid,attributes:{"data-icon":"search"}})])});var d={header:b,rows:c,attributes:{border:1}};return theme("jqm_table",d)}catch(e){console.log("theme_webform_results - "+e)}}function theme_webform_submission(a){try{var b="",c=[];c.push({data:"#"}),c.push({data:"Submitted"}),c.push({data:"User"}),c.push({data:"IP Address"});var d=[],e=new Date(1e3*a.result.submitted);e=e.toGMTString(),d.push([a.result.sid,e,a.result.user,a.result.remote_addr]);var f={header:c,rows:d,attributes:{border:1}};return b+=theme("jqm_table",f),$.each(a.result.data,function(c,d){b+="<h3>"+a.webform.webform.components[c].name+"</h3>",$.each(d.values,function(a,c){b+="<p>"+c+"</p>"})}),b}catch(g){console.log("theme_webform_submission - "+g)}}var _webform_hybrid_nid=null,webform_hybrid_components={},_webform_hybrid_expanding=!1;